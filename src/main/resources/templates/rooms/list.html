<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{shared/_header :: head(${pageTitle})}"></head>
<body>
<div th:replace="~{shared/_header :: navbar}"></div>

<main role="main" class="container my-5">

    <!-- Top header row: title + button -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h3 mb-1">Rooms</h1>
            <p class="text-muted mb-0">
                View all rooms in the hotel and their details.
            </p>
        </div>

        <a th:href="@{/rooms/create}" class="btn btn-primary">
            + Create Room
        </a>
    </div>

    <!-- No rooms message -->
    <div th:if="${#lists.isEmpty(rooms)}" class="alert alert-info">
        No rooms found. Please insert some sample data in the database.
    </div>

    <!-- Rooms table card -->
    <div th:if="${!#lists.isEmpty(rooms)}" class="card hero-card border-0">
        <div class="card-body p-4">
            <div class="table-responsive">
                <table class="table align-middle mb-0">
                    <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Number</th>
                        <th>Floor</th>
                        <th>Type</th>
                        <th>Price / Night</th>
                        <th>Capacity</th>
                        <th>Bed</th>
                        <th>Features</th>
                        <th>Status</th>
                        <th>Last Cleaned</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="room : ${rooms}">
                        <td th:text="${room.roomId}"></td>
                        <td th:text="${room.roomNumber}"></td>
                        <td th:text="${room.roomFloor}"></td>

                        <!-- Room type name or N/A -->
                        <td th:text="${room.roomType != null ? room.roomType.roomTypeName : 'N/A'}">
                            Standard
                        </td>

                        <!-- Price formatted -->
                        <td>
                            $<span th:text="${#numbers.formatDecimal(room.roomPricePerNight, 0, 'POINT', 2, 'POINT')}"></span>
                        </td>

                        <td th:text="${room.roomCapacity}"></td>

                        <!-- Bed info -->
                        <td th:text="${room.roomBedType}"></td>

                        <!-- Features: show short icons/text -->
                        <td>
                            <span th:if="${room.roomHasAC}" class="badge bg-secondary me-1">AC</span>
                            <span th:if="${room.roomHasWifi}" class="badge bg-secondary me-1">WiFi</span>
                            <span th:if="${room.roomHasTV}" class="badge bg-secondary me-1">TV</span>
                            <span th:if="${room.roomSmokingAllowed}"
                                  class="badge bg-danger-subtle border text-danger">
                                Smoking
                            </span>
                        </td>

                        <!-- Room status switch case -->
                        <td>
                            <span th:switch="${room.roomStatus}">

                                <span th:case="${T(nbcc.hotelmanagement.entities.enums.RoomStatus).AVAILABLE}"
                                      class="badge bg-success">
                                    Available
                                </span>

                                <span th:case="${T(nbcc.hotelmanagement.entities.enums.RoomStatus).OCCUPIED}"
                                      class="badge bg-danger">
                                    Occupied
                                </span>

                                <span th:case="${T(nbcc.hotelmanagement.entities.enums.RoomStatus).CLEANING}"
                                      class="badge bg-warning text-dark">
                                    Cleaning
                                </span>

                                <span th:case="${T(nbcc.hotelmanagement.entities.enums.RoomStatus).OUT_OF_SERVICE}"
                                      class="badge bg-secondary">
                                    Out of Service
                                </span>

                                <!-- fallback -->
                                <span th:case="*" class="badge bg-light text-muted border">
                                    Unknown
                                </span>

                            </span>
                        </td>

                        <!-- Last cleaned date -->
                        <td th:text="${room.roomLastCleanedDate}"></td>
                        <td>
                            <a th:href="@{|/rooms/edit/${room.roomId}|}"
                               class="btn btn-sm btn-outline-primary me-1">
                                Edit
                            </a>
                            <a th:href="@{/rooms/delete/{id}(id = ${room.roomId})}"
                               class="btn btn-sm btn-outline-danger me-1"
                               onclick="return confirm('Are you sure you want to delete this room?');"
                            >
                                Delete
                            </a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</main>

<div th:replace="~{shared/_footer :: footer}"></div>
</body>
</html>
